---
phase: 03.1-image-blur
plan: 01
type: execute
---

<objective>
Add heavy blur + lock icon overlay to deal images for anonymous users.

Purpose: Reinforce the "hidden until verified" pattern by obscuring business photos, creating visual incentive for account creation.
Output: BlurredImage component, updated DealCard and deal detail page with blur overlay.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03.1-image-blur/03.1-CONTEXT.md

**Prior work:**
@.planning/phases/03-deal-browsing/03-04-SUMMARY.md

**Key files:**
@src/components/features/dealCard.tsx
@src/app/deals/[id]/page.tsx

**Tech stack available:**
- Next.js Image component with fill/sizes
- Tailwind CSS v4 with blur utilities (backdrop-blur, blur filter)
- Phosphor Icons (Lock, LockKey)

**Established patterns:**
- Card variant="glass" for glassmorphic styling
- Badges positioned absolute on images
- Lock icon already used in DealCard footer for "Business details hidden"

**Constraining decisions:**
- [03-04]: Auth wall messaging pattern established
- Components use Phosphor icons only
- BlurredImage goes in patterns/ layer (reusable, business-agnostic)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BlurredImage pattern component</name>
  <files>src/components/patterns/blurredImage.tsx</files>
  <action>
Create a reusable BlurredImage component in patterns/ layer that:

1. Accepts same props as Next.js Image (src, alt, fill, sizes, className)
2. Adds heavy blur effect via CSS filter (blur(16px) or similar - heavy enough to obscure details)
3. Overlays a centered Lock icon from Phosphor (size 48, weight "light")
4. Shows a subtle "Unlock with account" message below the lock icon
5. Uses a semi-transparent dark overlay to enhance lock visibility

Structure:
```tsx
interface BlurredImageProps {
  src: string
  alt: string
  fill?: boolean
  sizes?: string
  className?: string
  // Future: isBlurred prop for auth-conditional reveal (Phase 4)
}
```

Styling approach:
- Image gets `filter: blur(16px)` via Tailwind's `blur-xl` class
- Dark overlay using `bg-bg-primary/60` or similar
- Lock icon centered with flexbox, uses text-text-secondary or text-white
- "Unlock with account" text below icon, small size, muted color
- Must handle both cases: image exists and fallback placeholder

Use Tailwind CSS only, no inline styles. Component should feel premium/mysterious, not broken.
  </action>
  <verify>File exists at src/components/patterns/blurredImage.tsx with BlurredImage export</verify>
  <done>BlurredImage component created with blur filter, dark overlay, centered Lock icon, and unlock message</done>
</task>

<task type="auto">
  <name>Task 2: Integrate BlurredImage into DealCard</name>
  <files>src/components/features/dealCard.tsx</files>
  <action>
Update DealCard to use BlurredImage instead of raw Next.js Image:

1. Import BlurredImage from @/components/patterns/blurredImage
2. Replace the Image component in the image section with BlurredImage
3. Keep all existing badge positioning (category top-left, discount top-right, sponsored bottom-left)
4. Badges should appear ON TOP of the blur overlay (z-index ordering)
5. Maintain the existing fallback Tag icon for no-image case (BlurredImage should handle this internally or DealCard wraps appropriately)

Important: The badges (Category, Discount %, Sponsored) must remain visible and sharp - only the underlying image is blurred. Use z-index or restructure the DOM so badges are outside/above the BlurredImage component.

Test both grid and list variants work correctly.
  </action>
  <verify>npm run build passes without errors</verify>
  <done>DealCard shows blurred images with lock overlay, badges remain visible and sharp above blur</done>
</task>

<task type="auto">
  <name>Task 3: Integrate BlurredImage into deal detail page</name>
  <files>src/app/deals/[id]/page.tsx</files>
  <action>
Update the deal detail page hero image section to use BlurredImage:

1. Import BlurredImage from @/components/patterns/blurredImage
2. Replace the Image in the hero section with BlurredImage
3. Keep badge positioning (category, featured) - they must remain visible above blur
4. Keep sponsored indicator visible above blur
5. Maintain the Tag icon fallback for no-image deals

The hero image (aspect-video container) should show:
- Blurred deal image as background
- Dark overlay with Lock icon + "Unlock with account" centered
- Category/Featured badges sharp and visible on top

Ensure the rounded-2xl container styling is preserved.
  </action>
  <verify>npm run build passes, visit /deals/[id] and see blurred hero image with lock overlay</verify>
  <done>Deal detail hero shows blurred image with lock overlay, badges visible above</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>BlurredImage component integrated into DealCard and deal detail page</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/deals
    3. Verify: Deal cards show heavily blurred images with centered lock icon
    4. Verify: "Unlock with account" text visible below lock
    5. Verify: Category badge, discount % badge, and sponsored indicator are SHARP (not blurred)
    6. Click any deal card
    7. Verify: Deal detail hero image is blurred with lock overlay
    8. Verify: Category/Featured badges on hero are sharp above blur
    9. Test grid and list view modes on browse page
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] BlurredImage component exists in patterns/ layer
- [ ] DealCard shows blur + lock on all deal images
- [ ] Deal detail hero shows blur + lock
- [ ] All badges remain sharp and visible above blur
- [ ] Effect feels premium/mysterious, not broken
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Blur effect is heavy enough to obscure business details
- Lock icon is prominent and centered
- Consistent experience across browse page and detail page
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-image-blur/03.1-01-SUMMARY.md`
</output>
