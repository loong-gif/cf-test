---
phase: 06-business-onboarding
plan: 01
type: execute
---

<objective>
Create business authentication context and business search UI for the claim flow.

Purpose: Enable business owners to authenticate and search for their business in the system.
Output: BusinessAuthContext, BusinessSearchModal, business onboarding entry point.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior patterns to follow:**
@src/lib/context/authContext.tsx - Consumer auth pattern to replicate for business
@src/components/features/authModal.tsx - Modal wrapper pattern
@src/components/patterns/cityPicker.tsx - Search/select pattern

**Business data:**
@src/types/business.ts - Business type with tier, claimedBy, claimedAt
@src/lib/mock-data/businesses.ts - Mock businesses data

**Relevant decisions:**
- Phase 04: AuthContext pattern with localStorage persistence
- Phase 04: Dynamic users array for session tracking
- Phase 05: Modal items-start positioning for tall content
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BusinessOwner type and BusinessAuthContext</name>
  <files>src/types/businessOwner.ts, src/lib/context/businessAuthContext.tsx</files>
  <action>
  1. Create BusinessOwner type in new file:
     - id, email, firstName, lastName, phone
     - businessId (linked business after claim)
     - verificationStatus: 'unverified' | 'pending' | 'verified'
     - claimStatus: 'none' | 'pending' | 'approved' | 'rejected'
     - createdAt, updatedAt

  2. Create BusinessAuthContext following AuthContext pattern:
     - STORAGE_KEY = 'costfinders_business_auth'
     - BusinessAuthState: owner, isAuthenticated, isLoading, error
     - signUp, signIn, signOut methods (mock, like consumer auth)
     - updateClaimStatus method to track claim progress
     - linkBusiness method to associate owner with business
     - Use dynamicOwners array for session tracking (mirror consumer pattern)
     - Export BusinessAuthProvider and useBusinessAuth hook

  3. Export BusinessOwner from types/index.ts

  Avoid: Don't add BusinessAuthProvider to layout yet - will be added in Plan 06-02.
  </action>
  <verify>npx tsc --noEmit passes, useBusinessAuth hook exports correctly</verify>
  <done>BusinessOwner type exists, BusinessAuthContext with full auth flow, hook exported</done>
</task>

<task type="auto">
  <name>Task 2: Create BusinessSearchModal component</name>
  <files>src/components/features/businessSearchModal.tsx</files>
  <action>
  Create BusinessSearchModal for business owners to search for their business:

  1. Modal structure following authModal.tsx pattern:
     - Use Modal from ui/modal.tsx
     - isOpen, onClose props
     - Title: "Find Your Business"

  2. Search functionality:
     - Input for business name search
     - Debounced search (300ms) against mock businesses
     - Filter businesses by name (case-insensitive contains)
     - Show results in a scrollable list

  3. Result card for each business:
     - Business name, address, city
     - Tier badge (unclaimed/free/paid)
     - "Claim This Business" button for unclaimed businesses
     - "Already Claimed" disabled state for claimed businesses

  4. Empty state: "No businesses found. Create a new listing?"

  5. Props:
     - isOpen: boolean
     - onClose: () => void
     - onSelect: (business: Business) => void
     - onCreateNew: () => void

  Use: MagnifyingGlass icon for search, Buildings icon for empty state
  </action>
  <verify>Component renders, search filters businesses, selection callback works</verify>
  <done>BusinessSearchModal with search, results, selection, and create-new option</done>
</task>

<task type="auto">
  <name>Task 3: Create business onboarding entry page</name>
  <files>src/app/business/page.tsx, src/app/business/layout.tsx</files>
  <action>
  Create the business portal entry point:

  1. Create src/app/business/layout.tsx:
     - Simple layout wrapper
     - No BusinessAuthProvider yet (added in Plan 06-02)
     - Just pass children through

  2. Create src/app/business/page.tsx:
     - "Are you a business owner?" hero section
     - Two CTA paths:
       a) "Find My Business" - opens BusinessSearchModal
       b) "List a New Business" - navigates to /business/create (built in 06-03)
     - Value propositions: "Claim your profile", "Manage your deals", "Connect with customers"
     - Glassmorphic card design matching site style

  3. Use useState to manage BusinessSearchModal open state

  4. When business selected from search:
     - Navigate to /business/claim/[businessId] (built in 06-02)

  Icons: Storefront for hero, MagnifyingGlass for search, Plus for create
  </action>
  <verify>npm run dev, navigate to /business, page renders, modal opens on click</verify>
  <done>/business page with dual CTAs, BusinessSearchModal integration, proper routing</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npx tsc --noEmit` passes
- [ ] /business page renders with glassmorphic styling
- [ ] BusinessSearchModal opens and searches businesses
- [ ] Selecting a business navigates (route will 404 until 06-02)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- BusinessAuthContext pattern matches AuthContext structure
- BusinessSearchModal provides intuitive search experience
- /business entry page guides owners to claim or create
</success_criteria>

<output>
After completion, create `.planning/phases/06-business-onboarding/06-01-SUMMARY.md`
</output>
