---
phase: 06-business-onboarding
plan: 03
type: execute
---

<objective>
Create new business flow for owners whose business isn't in the system yet.

Purpose: Allow new businesses to create a listing and complete onboarding.
Output: CreateBusinessForm, new business creation page, onboarding completion state.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-business-onboarding/06-01-SUMMARY.md (if exists)
@.planning/phases/06-business-onboarding/06-02-SUMMARY.md (if exists)

**Prior patterns to follow:**
@src/lib/context/businessAuthContext.tsx - Business auth context
@src/components/features/claimBusinessFlow.tsx - Multi-step flow pattern
@src/components/features/profileForm.tsx - Form layout pattern

**Business data:**
@src/types/business.ts - Business type
@src/lib/mock-data/businesses.ts - Business utilities

**Relevant decisions:**
- Phase 05: Auto-save preferences pattern
- Phase 04: Form validation with inline errors
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CreateBusinessForm component</name>
  <files>src/components/features/createBusinessForm.tsx</files>
  <action>
  Create multi-section form for new business creation:

  Section 1 - Business Details:
  - Business name (required)
  - Description (textarea, optional)
  - Website (optional)

  Section 2 - Location:
  - Address (required)
  - City (required)
  - State (required, dropdown with TX, CA, NY, FL, etc.)
  - Zip code (required)
  - Location area (optional, e.g., "Downtown", "North Side")

  Section 3 - Contact:
  - Business phone (required)
  - Business email (required)

  Form behavior:
  - Validation: required fields, email format, phone format (10+ digits)
  - Submit button: "Create Business Listing"
  - On submit: create business in mock data, return new business ID
  - Error states inline like SignUpForm

  Props:
  - onSubmit: (business: Business) => void
  - isLoading?: boolean

  Use glassmorphic card sections, Input components from ui/, proper spacing
  </action>
  <verify>Form renders, validation works, submit callback fires with form data</verify>
  <done>CreateBusinessForm with all fields, validation, submit handler</done>
</task>

<task type="auto">
  <name>Task 2: Create new business page with auth flow</name>
  <files>src/app/business/create/page.tsx</files>
  <action>
  Create /business/create page with integrated auth:

  1. Check useBusinessAuth - if not authenticated:
     - Show sign-up/sign-in section first
     - "Create an account to list your business"
     - After auth, show CreateBusinessForm

  2. If authenticated:
     - Show CreateBusinessForm directly
     - Prefill email from authenticated owner

  3. On form submit:
     - Create business in mock data (use utility from 06-02)
     - Link business to owner via linkBusiness
     - Set owner claimStatus to 'approved' (new businesses are auto-approved)
     - Navigate to success state

  4. Success state (inline, not separate page):
     - "Your business has been created!"
     - Show business name and basic details
     - "Your listing will go live after review" (mock, no actual review)
     - CTA: "Go to Business Dashboard" → /business/dashboard

  Page title: "List Your Business"
  Use: Plus for create, Storefront for success, ArrowRight for CTA
  </action>
  <verify>Navigate to /business/create, auth flow works, business creation succeeds</verify>
  <done>/business/create with auth gate, form, and success state</done>
</task>

<task type="auto">
  <name>Task 3: Add createBusiness utility and wire up navigation</name>
  <files>src/lib/mock-data/businesses.ts, src/app/business/page.tsx</files>
  <action>
  1. In businesses.ts, add createBusiness function:
     - Takes: Omit<Business, 'id' | 'createdAt' | 'updatedAt' | 'rating' | 'reviewCount' | 'isVerified'>
     - Generates: id (biz-{timestamp}), slug (from name), timestamps
     - Sets: tier='free', status='active', rating=0, reviewCount=0, isVerified=false
     - Adds to dynamicBusinesses array
     - Returns the new Business object

  2. Update /business page.tsx:
     - When BusinessSearchModal "Create New" is clicked, navigate to /business/create
     - Wire up the onCreateNew prop properly
     - Update onSelect to navigate to /business/claim/[id]

  3. Ensure BusinessSearchModal can find newly created businesses:
     - searchBusinessesByName should search both static and dynamic businesses

  This completes the full loop: search → not found → create → success
  </action>
  <verify>Create new business, find it in search, full flow works end-to-end</verify>
  <done>createBusiness utility, navigation wired, search finds new businesses</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] /business/create page renders with auth gate
- [ ] Form validation works (required fields, formats)
- [ ] New business appears in search after creation
- [ ] Full flow: /business → search → not found → create → success
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Business owners can create new listings
- New businesses are searchable immediately
- Phase 6 complete: both claim and create flows functional
</success_criteria>

<output>
After completion, create `.planning/phases/06-business-onboarding/06-03-SUMMARY.md`:

# Phase 6 Plan 3: Create New Business Flow Summary

**[Substantive one-liner]**

## Accomplishments
- [Key outcomes]

## Files Created/Modified
- [List files]

## Decisions Made
- [Key decisions]

## Issues Encountered
- [Problems and resolutions, or "None"]

## Next Phase Readiness
- Phase 6 complete
- Ready for Phase 7: Business Dashboard
- BusinessAuthContext and business data utilities ready for dashboard features
</output>
