---
phase: 07-business-dashboard
plan: 02
type: execute
---

<objective>
Create deal management system for businesses to view, create, edit, and control their deals.

Purpose: Enable business owners to manage their deal offerings through a complete CRUD interface.
Output: Deal list page with table view, create/edit deal forms, and deal status controls.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

# Prior plan context:
@.planning/phases/07-business-dashboard/07-01-SUMMARY.md

# Types and mock data:
@src/types/deal.ts
@src/lib/mock-data/deals.ts

# Business context:
@src/lib/context/businessAuthContext.tsx
@src/types/business.ts

**Tech stack available:** Deal type, TreatmentCategory, existing deals mock data
**Established patterns:** Glassmorphic cards, form validation, table/grid layouts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DealList component with table view</name>
  <files>src/components/features/dealManagement/dealList.tsx</files>
  <action>Create DealList component displaying business's deals in a table format. Columns: Title, Category (badge), Price (original/deal), Status (active/paused badge), Claims, Views, Actions. Include:
- Filter tabs: All, Active, Paused
- Search input for deal titles
- "Create Deal" button (links to create page)
- Row actions: Edit (PencilSimple), Pause/Activate toggle (Pause/Play), Delete (Trash) with confirmation
- Empty state when no deals

Use Table-like layout with glassmorphic styling. Filter by businessId from context. Create mock utility getDealsForBusiness(businessId) in deals.ts that filters deals.</action>
  <verify>Component renders without errors, displays deals filtered by business</verify>
  <done>DealList shows business deals with filtering, search, and action buttons</done>
</task>

<task type="auto">
  <name>Task 2: Create DealForm component for create/edit</name>
  <files>src/components/features/dealManagement/dealForm.tsx</files>
  <action>Create DealForm component for creating and editing deals. Fields:
- Title (text input, required)
- Description (textarea, required)
- Category (select dropdown with TreatmentCategory options)
- Original Price (number input)
- Deal Price (number input)
- Unit (text input, e.g., "per unit", "per session")
- Min/Max Units (optional number inputs)
- Valid From/Until (date inputs)
- Terms & Conditions (textarea)
- Image URL (text input, optional)
- Featured toggle (checkbox)

Form validates: title required, deal price < original price, valid dates. Submit creates/updates deal. Use existing form patterns from CreateBusinessForm. Add createDeal and updateDeal mock utilities.</action>
  <verify>Form renders all fields, validation works, submit handler fires</verify>
  <done>DealForm handles both create and edit modes with full validation</done>
</task>

<task type="auto">
  <name>Task 3: Create deal management pages</name>
  <files>src/app/business/dashboard/deals/page.tsx, src/app/business/dashboard/deals/new/page.tsx, src/app/business/dashboard/deals/[dealId]/edit/page.tsx</files>
  <action>Create three pages:

1. /business/dashboard/deals - List page with DealList component, page title "Manage Deals"

2. /business/dashboard/deals/new - Create page with DealForm in create mode, breadcrumb back to list

3. /business/dashboard/deals/[dealId]/edit - Edit page with DealForm pre-populated with deal data, uses getDealById utility

All pages use business dashboard layout. Include success/error toast feedback using existing toast patterns or inline messages. After create/edit success, redirect to deals list.</action>
  <verify>npm run build passes, all three routes accessible and functional</verify>
  <done>Deal management pages complete: list, create, edit with full CRUD flow</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] /business/dashboard/deals shows deal list
- [ ] /business/dashboard/deals/new creates new deals
- [ ] /business/dashboard/deals/[id]/edit loads and updates existing deals
- [ ] Deal status toggle (pause/activate) works
- [ ] Form validation prevents invalid submissions
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Full deal CRUD functionality working
- UI matches glassmorphic design system
</success_criteria>

<output>
After completion, create `.planning/phases/07-business-dashboard/07-02-SUMMARY.md`
</output>
