---
phase: 11-design-system-audit
plan: 01
type: execute
---

<objective>
Audit the existing design system and document all inconsistencies for systematic resolution.

Purpose: Create a comprehensive audit document identifying every hardcoded color, spacing inconsistency, and pattern deviation across the codebase. This becomes the source of truth for what needs fixing in subsequent plans.
Output: DESIGN-AUDIT.md with all inconsistencies catalogued, plus DESIGN-TOKENS-REFERENCE.md documenting the unified token system.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/CONVENTIONS.md
@.planning/codebase/CONCERNS.md

@src/app/globals.css
@src/lib/design-tokens.ts
@src/components/ui/button.tsx
@src/components/ui/card.tsx
@src/components/ui/badge.tsx
@src/components/ui/input.tsx

**Prior context:** v1.0 shipped with glassmorphic design system. User identified inconsistent styling, poor navigation flow, and missing shared components as v1.1 goals.

**Known issues from explore agent:**
- 84 instances of hardcoded semantic colors (red-500, green-500, blue-500, amber-500)
- Badge component using hardcoded colors instead of design tokens
- Input component using hardcoded error colors
- Treatment categories page with ad-hoc color mapping
- GlobalHeader hidden on dashboards without clear rationale
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create comprehensive design audit document</name>
  <files>.planning/phases/11-design-system-audit/DESIGN-AUDIT.md</files>
  <action>
Scan the entire codebase and create a structured audit document with:

1. **Color Token Violations** - Search for hardcoded Tailwind colors:
   - `grep -r "red-[0-9]" src/ --include="*.tsx"`
   - `grep -r "green-[0-9]" src/ --include="*.tsx"`
   - `grep -r "blue-[0-9]" src/ --include="*.tsx"`
   - `grep -r "amber-[0-9]" src/ --include="*.tsx"`
   - `grep -r "yellow-[0-9]" src/ --include="*.tsx"`
   - `grep -r "purple-[0-9]" src/ --include="*.tsx"`
   - `grep -r "pink-[0-9]" src/ --include="*.tsx"`
   - `grep -r "teal-[0-9]" src/ --include="*.tsx"`

   Document each file, line, and the exact hardcoded value.

2. **Spacing Violations** - Search for arbitrary spacing:
   - `grep -r "\[.*px\]" src/ --include="*.tsx"` (arbitrary pixel values)
   - `grep -r "p-[0-9]" src/ --include="*.tsx"` and compare to token usage

3. **Component Pattern Deviations** - Check for:
   - Components not using Card from ui/ when they should
   - Components not using Button from ui/ when they should
   - Inline styles instead of Tailwind classes

4. **Header/Navigation Inconsistencies** - Document:
   - Which pages use GlobalHeader
   - Which pages hide GlobalHeader
   - Which pages have their own header implementation

Format the document with:
- Summary statistics (total violations by category)
- Tables listing each violation with file path, line number, current value, recommended fix
- Priority ranking (high: visible to users, medium: internal state, low: edge cases)
  </action>
  <verify>
cat .planning/phases/11-design-system-audit/DESIGN-AUDIT.md | head -50
grep -c "│" .planning/phases/11-design-system-audit/DESIGN-AUDIT.md  # Should have tables
  </verify>
  <done>
DESIGN-AUDIT.md exists with:
- Summary statistics section
- Color violations table with 50+ entries
- Spacing violations section
- Header/navigation analysis
- Priority ranking
  </done>
</task>

<task type="auto">
  <name>Task 2: Create design tokens reference document</name>
  <files>.planning/phases/11-design-system-audit/DESIGN-TOKENS-REFERENCE.md</files>
  <action>
Create a developer reference document that maps:

1. **Current CSS Variables** - Document all variables in globals.css :root:
   - Colors (bg, surface, glass, text, brand, semantic)
   - Shadows (sm, md, lg, glass, elevated, product photography)
   - Blur values
   - Radius values
   - Spacing scale
   - Transitions

2. **Tailwind @theme Utilities** - Document what's available via @theme inline:
   - Which CSS variables are exposed as Tailwind utilities
   - Naming convention: `bg-{var-name}`, `text-{var-name}`, etc.

3. **design-tokens.ts Exports** - Document the JS tokens file:
   - colors object (background, text, brand, semantic)
   - shadows object
   - blur object
   - When to use CSS variables vs JS tokens

4. **Usage Guidelines** - Clear instructions:
   - DO: Use `bg-bg-primary`, `text-text-secondary`, `bg-glass-bg`
   - DON'T: Use `bg-[#4c5578]`, `text-slate-300`, arbitrary values
   - For semantic colors: Use `text-success`, `bg-error/10` (WILL be added in 11-02)
   - For status badges: Use semantic color tokens, not raw green/red

5. **Migration Patterns** - Show before/after for common fixes:
   - `text-red-500` → `text-error`
   - `bg-green-500/10` → `bg-success/10`
   - `text-amber-400` → `text-warning`

This document becomes the canonical reference for Phase 12-15 polish work.
  </action>
  <verify>
cat .planning/phases/11-design-system-audit/DESIGN-TOKENS-REFERENCE.md | head -80
grep "DO:" .planning/phases/11-design-system-audit/DESIGN-TOKENS-REFERENCE.md
  </verify>
  <done>
DESIGN-TOKENS-REFERENCE.md exists with:
- Complete CSS variable documentation
- Tailwind utility mapping
- Usage guidelines section with DO/DON'T examples
- Migration patterns for common fixes
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] DESIGN-AUDIT.md has detailed violation inventory
- [ ] All violation categories covered (colors, spacing, patterns)
- [ ] DESIGN-TOKENS-REFERENCE.md provides clear usage guidance
- [ ] Migration patterns documented for common issues
- [ ] Both files are well-formatted markdown
</verification>

<success_criteria>
- All tasks completed
- Audit document has actionable violation list with file:line references
- Reference document enables developers to use tokens correctly
- No errors in document generation
</success_criteria>

<output>
After completion, create `.planning/phases/11-design-system-audit/11-01-SUMMARY.md`
</output>
