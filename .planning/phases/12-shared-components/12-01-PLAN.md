---
phase: 12-shared-components
plan: 01
type: execute
---

<objective>
Create shared navigation components by extracting common patterns from the 3 role-specific sidebars and dashboard layouts.

Purpose: Eliminate ~90% code duplication across consumer/business/admin navigation, establishing a single source of truth for sidebar and layout patterns.
Output: Two new shared components (BaseSidebar, AuthenticatedDashboardLayout) that role-specific implementations can compose.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context
@.planning/phases/11-design-system-audit/11-03-SUMMARY.md

# Source files to extract from (reference implementations)
@src/components/layout/dashboardSidebar.tsx
@src/components/layout/businessDashboardSidebar.tsx
@src/components/layout/adminDashboardSidebar.tsx
@src/app/dashboard/layout.tsx
@src/app/business/dashboard/layout.tsx
@src/app/admin/dashboard/layout.tsx

**Tech stack available:** Next.js 16, React, TypeScript, Tailwind CSS v4, Phosphor Icons
**Established patterns:** Glassmorphic styling (bg-glass-bg backdrop-blur-xl), icon-only sidebar with tooltips, semantic color tokens
**Layer rules:** Layout components can import from all layers (ui, patterns, features, lib)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BaseSidebar component</name>
  <files>src/components/layout/baseSidebar.tsx</files>
  <action>
Extract shared sidebar logic from the 3 role-specific sidebars into a configurable BaseSidebar component.

**Props interface:**
```typescript
interface NavItem {
  href: string
  label: string
  icon: React.ComponentType<{ size?: number; weight?: 'light' | 'fill' }>
}

interface BaseSidebarProps {
  navItems: NavItem[]
  baseRoute: string  // e.g., '/dashboard', '/business/dashboard', '/admin/dashboard'
  user: {
    displayName: string
    initial: string
  } | null
  onSignOut: () => void
  mobileNavCount?: number  // defaults to 5, how many items to show on mobile
}
```

**Implementation:**
- Copy structure from dashboardSidebar.tsx as base
- Replace hardcoded navItems with props.navItems
- Replace isActive logic to use props.baseRoute for exact match check
- Replace user section to use props.user.displayName and props.user.initial
- Replace signOut call with props.onSignOut
- Add mobileNavCount prop with default of 5 for mobile slice

**Keep unchanged:**
- Desktop sidebar structure (aside with fixed positioning, w-16, icon nav)
- Mobile bottom nav structure (fixed bottom, justify-around)
- All glassmorphic styling (bg-glass-bg backdrop-blur-xl border-white/10)
- Tooltip integration for desktop nav items
- Active state styling (bg-brand-primary/10 text-brand-primary)
- Icon weight toggle (fill when active, light when inactive)

**Do NOT:**
- Add auth context imports - auth is handled by wrapper components
- Add router imports - navigation handled by Link components
- Change any visual styling - this is pure extraction
  </action>
  <verify>TypeScript compiles without errors: `npm run build` passes</verify>
  <done>BaseSidebar.tsx exists with configurable props, exports BaseSidebarProps and NavItem types</done>
</task>

<task type="auto">
  <name>Task 2: Create AuthenticatedDashboardLayout component</name>
  <files>src/components/layout/authenticatedDashboardLayout.tsx</files>
  <action>
Extract shared dashboard layout pattern from the 3 role-specific layouts into a configurable component.

**Props interface:**
```typescript
interface AuthenticatedDashboardLayoutProps {
  children: React.ReactNode
  sidebar: React.ReactNode
  isLoading: boolean
  isAuthenticated: boolean
  redirectPath: string  // where to redirect if not authenticated
}
```

**Implementation:**
- Copy loading spinner from dashboard/layout.tsx (SVG spinner with brand-primary color)
- Copy main content wrapper structure: `<div className="min-h-screen">` with sidebar + main
- Main content classes: `md:pl-16 pt-20 pb-20 md:pb-0 px-4 sm:px-6 lg:px-8`
- Inner container: `max-w-6xl mx-auto py-6`

**Behavior:**
- If isLoading: render loading spinner centered
- If !isAuthenticated: redirect to redirectPath and return null
- If authenticated: render sidebar + main content wrapper with children

**Import requirements:**
- useEffect from 'react'
- useRouter from 'next/navigation'

**Do NOT:**
- Import any auth contexts - auth state passed as props
- Handle business-specific validation (businessId check) - that stays in business layout
- Change any styling - pure extraction
  </action>
  <verify>TypeScript compiles without errors: `npm run build` passes</verify>
  <done>AuthenticatedDashboardLayout.tsx exists with configurable props, handles loading/redirect/render states</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] BaseSidebar component exports BaseSidebarProps and NavItem types
- [ ] AuthenticatedDashboardLayout component exports AuthenticatedDashboardLayoutProps type
- [ ] Both components are in src/components/layout/
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Components ready for migration in 12-02
</success_criteria>

<output>
After completion, create `.planning/phases/12-shared-components/12-01-SUMMARY.md`
</output>
