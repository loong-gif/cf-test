---
phase: 13-navigation-overhaul
plan: 01
type: execute
---

<objective>
Create PageHeader component with breadcrumb navigation and route hierarchy configuration.

Purpose: Establish reusable navigation patterns for consistent page hierarchy across all dashboard modules.
Output: PageHeader pattern component + route configuration for breadcrumb generation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context
@.planning/phases/12-shared-components/12-01-SUMMARY.md

# Layout components to integrate with
@src/components/layout/authenticatedDashboardLayout.tsx

# Existing patterns for reference
@src/components/patterns/categoryFilter.tsx

# Route structure reference
Dashboard routes:
- /dashboard (consumer) → /dashboard/favorites, /dashboard/claims, /dashboard/settings
- /business/dashboard → /business/dashboard/deals, /business/dashboard/leads, /business/dashboard/messages, /business/dashboard/analytics, /business/dashboard/profile, /business/dashboard/settings
- /admin/dashboard → /admin/dashboard/deals, /admin/dashboard/users, /admin/dashboard/businesses, /admin/dashboard/content, /admin/dashboard/reports, /admin/dashboard/monetization, /admin/dashboard/data, /admin/dashboard/settings

**Tech stack available:** Next.js 16, React, TypeScript, Tailwind CSS v4, Phosphor Icons
**Established patterns:** Pattern layer components (ui-agnostic, reusable)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create route hierarchy configuration</name>
  <files>src/lib/routes.ts</files>
  <action>
Create a route configuration file that defines the hierarchy and labels for breadcrumb generation.

Structure:
```typescript
export interface RouteConfig {
  label: string
  parent?: string // Parent route path for hierarchy
}

export const routeConfig: Record<string, RouteConfig> = {
  // Consumer dashboard
  '/dashboard': { label: 'Dashboard' },
  '/dashboard/favorites': { label: 'Favorites', parent: '/dashboard' },
  '/dashboard/claims': { label: 'My Claims', parent: '/dashboard' },
  '/dashboard/settings': { label: 'Settings', parent: '/dashboard' },

  // Business dashboard
  '/business/dashboard': { label: 'Dashboard' },
  '/business/dashboard/deals': { label: 'Deals', parent: '/business/dashboard' },
  '/business/dashboard/deals/new': { label: 'New Deal', parent: '/business/dashboard/deals' },
  '/business/dashboard/deals/sponsored': { label: 'Sponsored', parent: '/business/dashboard/deals' },
  '/business/dashboard/leads': { label: 'Leads', parent: '/business/dashboard' },
  '/business/dashboard/leads/pricing': { label: 'Lead Pricing', parent: '/business/dashboard/leads' },
  '/business/dashboard/messages': { label: 'Messages', parent: '/business/dashboard' },
  '/business/dashboard/analytics': { label: 'Analytics', parent: '/business/dashboard' },
  '/business/dashboard/profile': { label: 'Profile', parent: '/business/dashboard' },
  '/business/dashboard/settings': { label: 'Settings', parent: '/business/dashboard' },
  '/business/dashboard/settings/integrations': { label: 'Integrations', parent: '/business/dashboard/settings' },
  '/business/dashboard/settings/account': { label: 'Account & Billing', parent: '/business/dashboard/settings' },
  '/business/dashboard/settings/account/checkout': { label: 'Checkout', parent: '/business/dashboard/settings/account' },

  // Admin dashboard
  '/admin/dashboard': { label: 'Dashboard' },
  '/admin/dashboard/deals': { label: 'Deals', parent: '/admin/dashboard' },
  '/admin/dashboard/users': { label: 'Users', parent: '/admin/dashboard' },
  '/admin/dashboard/businesses': { label: 'Businesses', parent: '/admin/dashboard' },
  '/admin/dashboard/content': { label: 'Content', parent: '/admin/dashboard' },
  '/admin/dashboard/content/categories': { label: 'Categories', parent: '/admin/dashboard/content' },
  '/admin/dashboard/content/locations': { label: 'Locations', parent: '/admin/dashboard/content' },
  '/admin/dashboard/content/treatments': { label: 'Treatments', parent: '/admin/dashboard/content' },
  '/admin/dashboard/reports': { label: 'Reports', parent: '/admin/dashboard' },
  '/admin/dashboard/monetization': { label: 'Monetization', parent: '/admin/dashboard' },
  '/admin/dashboard/data': { label: 'Data', parent: '/admin/dashboard' },
  '/admin/dashboard/settings': { label: 'Settings', parent: '/admin/dashboard' },
}
```

Add helper function to build breadcrumb trail:
```typescript
export interface Breadcrumb {
  label: string
  href: string
  isCurrentPage: boolean
}

export function getBreadcrumbs(pathname: string): Breadcrumb[] {
  const breadcrumbs: Breadcrumb[] = []
  let currentPath = pathname

  // Handle dynamic routes by finding closest static match
  // e.g., /business/dashboard/deals/abc123/edit → /business/dashboard/deals
  while (currentPath && !routeConfig[currentPath]) {
    // Try removing last segment
    const segments = currentPath.split('/')
    segments.pop()
    currentPath = segments.join('/') || '/'
    if (currentPath === '/') break
  }

  // Build breadcrumb chain from current to root
  let path: string | undefined = currentPath
  while (path && routeConfig[path]) {
    breadcrumbs.unshift({
      label: routeConfig[path].label,
      href: path,
      isCurrentPage: path === currentPath,
    })
    path = routeConfig[path].parent
  }

  return breadcrumbs
}
```

Do NOT use barrel exports. Export directly from this file.
  </action>
  <verify>`npm run build` passes, no TypeScript errors</verify>
  <done>Route config exists with all dashboard routes, getBreadcrumbs helper works</done>
</task>

<task type="auto">
  <name>Task 2: Create PageHeader component</name>
  <files>src/components/patterns/pageHeader.tsx</files>
  <action>
Create a reusable PageHeader component in the patterns layer.

Features:
- Auto-generates breadcrumbs from current pathname using route config
- Shows back button when not on root dashboard page
- Responsive: full breadcrumbs on desktop, condensed on mobile
- Follows glassmorphic styling patterns

Implementation:
```typescript
'use client'

import Link from 'next/link'
import { usePathname, useRouter } from 'next/navigation'
import { ArrowLeft, CaretRight, House } from '@phosphor-icons/react'
import { getBreadcrumbs, type Breadcrumb } from '@/lib/routes'

interface PageHeaderProps {
  /** Override the auto-generated title */
  title?: string
  /** Show back button (auto-detected if not provided) */
  showBack?: boolean
  /** Custom back URL (defaults to parent route) */
  backUrl?: string
}

export function PageHeader({ title, showBack, backUrl }: PageHeaderProps) {
  const pathname = usePathname()
  const router = useRouter()
  const breadcrumbs = getBreadcrumbs(pathname)

  // Determine if we should show back button
  const hasParent = breadcrumbs.length > 1
  const shouldShowBack = showBack ?? hasParent
  const parentUrl = backUrl ?? breadcrumbs[breadcrumbs.length - 2]?.href

  // Get current page title
  const currentBreadcrumb = breadcrumbs[breadcrumbs.length - 1]
  const pageTitle = title ?? currentBreadcrumb?.label ?? 'Dashboard'

  // Don't render if on root dashboard (no breadcrumbs to show)
  if (breadcrumbs.length <= 1 && !title) {
    return null
  }

  const handleBack = () => {
    if (parentUrl) {
      router.push(parentUrl)
    } else {
      router.back()
    }
  }

  return (
    <div className="mb-6">
      {/* Breadcrumbs - hidden on mobile, shown on tablet+ */}
      {breadcrumbs.length > 1 && (
        <nav className="hidden sm:flex items-center gap-1.5 text-sm mb-2" aria-label="Breadcrumb">
          {breadcrumbs.map((crumb, index) => (
            <div key={crumb.href} className="flex items-center gap-1.5">
              {index > 0 && (
                <CaretRight size={14} weight="bold" className="text-text-muted" />
              )}
              {crumb.isCurrentPage ? (
                <span className="text-text-primary font-medium">{crumb.label}</span>
              ) : (
                <Link
                  href={crumb.href}
                  className="text-text-secondary hover:text-text-primary transition-colors"
                >
                  {crumb.label}
                </Link>
              )}
            </div>
          ))}
        </nav>
      )}

      {/* Title with optional back button */}
      <div className="flex items-center gap-3">
        {shouldShowBack && (
          <button
            type="button"
            onClick={handleBack}
            className="p-2 -ml-2 rounded-xl text-text-secondary hover:text-text-primary hover:bg-glass-bg transition-all"
            aria-label="Go back"
          >
            <ArrowLeft size={20} weight="light" />
          </button>
        )}
        <h1 className="text-2xl font-bold text-text-primary">{pageTitle}</h1>
      </div>
    </div>
  )
}
```

Key design decisions:
- Pattern layer: No auth context, no business logic, just UI composition
- Uses route config for breadcrumb generation
- Back button uses router.push for consistent navigation (not router.back which can leave the site)
- Responsive: breadcrumbs hidden on mobile (back button sufficient)
- Glassmorphic hover states on interactive elements
  </action>
  <verify>`npm run build` passes, no TypeScript errors</verify>
  <done>PageHeader component renders breadcrumbs and back button, follows pattern layer rules</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Route config covers all dashboard routes
- [ ] getBreadcrumbs correctly builds hierarchy chain
- [ ] PageHeader component follows pattern layer rules (no business logic)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Ready for integration in 13-02
</success_criteria>

<output>
After completion, create `.planning/phases/13-navigation-overhaul/13-01-SUMMARY.md`
</output>
