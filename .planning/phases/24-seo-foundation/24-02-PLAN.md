---
phase: 24-seo-foundation
plan: 02
type: execute
---

<objective>
Create programmatic sitemap and establish SEO utility library for metadata and schema generation.

Purpose: Enable search engines to discover all CostFinders pages (static + dynamic location pages) and provide reusable utilities for building page-specific metadata.
Output: Working sitemap.ts, src/lib/seo/ directory with metadata helpers and schema builders
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/24-seo-foundation/24-RESEARCH.md
@.planning/phases/24-seo-foundation/24-KEYWORD-RESEARCH.md
@.planning/phases/24-seo-foundation/24-01-SUMMARY.md

**From 24-01:** Root metadata foundation in place, robots.ts created, dependencies installed

**Current location data:**
- 11 cities in Orange County, CA (Costa Mesa, Foothill Ranch, Irvine, Laguna Beach, Laguna Hills, Laguna Woods, Lake Forest, Mission Viejo, Newport Beach, Santa Ana, Tustin)
- 1 state (CA)
- 1 region (Orange County)
- Data in src/lib/mock-data/locations.ts

**From keyword research (24-KEYWORD-RESEARCH.md) - Orange County Keywords:**
| City | Top Keyword | Monthly Volume | Priority |
|------|-------------|----------------|----------|
| Newport Beach | medspa newport beach | 1,000 | Tier 1 |
| Irvine | botox irvine | 390 | Tier 1 |
| Orange County | botox orange county | 590 | Region |
| Santa Ana | botox santa ana | 90 | Tier 2 |
| Tustin | botox tustin | 90 | Tier 2 |
| Costa Mesa | lip filler costa mesa | 50 | Tier 2 |

**Location page title pattern (keyword-optimized):**
`{City} MedSpa Deals | Botox & Lip Filler Prices | CostFinders`

**Regional title pattern:**
`Orange County MedSpa Deals | Compare Botox & Lip Filler Prices | CostFinders`

**Key pages to include:**
- Static: /, /deals, /about (if exists), /contact (if exists)
- Dynamic: Future state/city pages will use generateStaticParams

@src/lib/mock-data/locations.ts
@src/app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sitemap.ts with static and location pages</name>
  <files>src/app/sitemap.ts</files>
  <action>
    Create new file src/app/sitemap.ts:
    1. Import MetadataRoute from 'next'
    2. Import getCities from '@/lib/mock-data/locations'
    3. Export default async function sitemap(): Promise<MetadataRoute.Sitemap>
    4. Define baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'https://costfinders.com'
    5. Build static pages array:
       - { url: baseUrl, lastModified: new Date(), changeFrequency: 'weekly', priority: 1.0 }
       - { url: `${baseUrl}/deals`, lastModified: new Date(), changeFrequency: 'daily', priority: 0.9 }
    6. Build location pages from getCities() (for future state/city routes):
       - Map cities to future URLs like `${baseUrl}/${slugify(state)}/${slugify(city)}`
       - changeFrequency: 'weekly', priority: 0.7
    7. Return combined array

    Helper: Create inline slugify function (lowercase, replace spaces with hyphens).
    Note: Location URLs are placeholders for Phase 25-27 routes; sitemap is forward-looking.
  </action>
  <verify>Run `npm run dev`, visit http://localhost:3000/sitemap.xml and verify XML output</verify>
  <done>sitemap.xml returns valid XML with all static pages + location placeholder URLs</done>
</task>

<task type="auto">
  <name>Task 2: Create SEO utility library structure</name>
  <files>src/lib/seo/index.ts, src/lib/seo/metadata.ts, src/lib/seo/schemas.ts</files>
  <action>
    Create src/lib/seo/ directory with three files:

    **src/lib/seo/metadata.ts:**
    - Export generateLocationMetadata(city, region, dealCount): Metadata
      - Title pattern (keyword-optimized): `${city} MedSpa Deals | Botox & Lip Filler Prices | CostFinders`
      - Description pattern: `Compare Botox and medspa prices in ${city}. Find verified deals on lip fillers, facials & skincare treatments. ${dealCount} deals available near you.`
      - Returns title, description, openGraph, alternates.canonical for location pages
      - Based on keyword research: "medspa newport beach" (1,000/mo), "botox irvine" (390/mo)
    - Export SITE_CONFIG object with name, url, description, social handles
      - description: 'Compare medspa prices in Orange County. Find the best deals on Botox, lip fillers, and skincare treatments in Newport Beach, Irvine & nearby cities.'
    - Helper: buildCanonicalUrl(path: string) using metadataBase
    - Export ORANGE_COUNTY_CITIES array with all 11 target cities and their keyword priorities:
      - Tier 1: Newport Beach, Irvine
      - Tier 2: Santa Ana, Tustin, Costa Mesa
      - Tier 3: Laguna Beach, Laguna Hills, Mission Viejo, Lake Forest, Laguna Woods, Foothill Ranch
    - Export KEYWORD_DATA object with high-value keywords for reference:
      - primaryKeywords: ['botox cost', 'lip filler cost', 'medspa prices', 'microneedling cost']
      - locationPatterns: { title: '{City} MedSpa Deals | Botox & Lip Filler Prices', h1: 'Compare MedSpa Prices in {City}' }
      - regionPattern: { title: 'Orange County MedSpa Deals | Compare Botox & Lip Filler Prices' }

    **src/lib/seo/schemas.ts:**
    - Import types from schema-dts: WithContext, WebSite, Organization, BreadcrumbList
    - Export buildWebsiteSchema(): WithContext<WebSite>
      - Standard schema for the website entity
    - Export buildOrganizationSchema(): WithContext<Organization>
      - CostFinders organization with logo, social links
    - Export buildBreadcrumbSchema(items: {name, url}[]): WithContext<BreadcrumbList>
      - Reusable breadcrumb builder for location hierarchy

    **src/lib/seo/index.ts:**
    - Barrel export from metadata.ts and schemas.ts
    - Export types and functions for easy imports

    Use schema-dts types for full type safety. All schemas return JSON-LD objects (not JSX yet).
  </action>
  <verify>Run `npm run build` to verify TypeScript compiles. Check types resolve correctly.</verify>
  <done>src/lib/seo/ directory exists with 3 files, all exports type-check successfully</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] http://localhost:3000/sitemap.xml returns valid XML
- [ ] src/lib/seo/ contains metadata.ts, schemas.ts, index.ts
- [ ] Schema builder functions export proper WithContext types
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Sitemap accessible, SEO utilities ready for component usage
</success_criteria>

<output>
After completion, create `.planning/phases/24-seo-foundation/24-02-SUMMARY.md`
</output>
