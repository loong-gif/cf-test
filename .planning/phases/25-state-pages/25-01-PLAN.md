---
phase: 25-state-pages
plan: 01
type: execute
---

<objective>
Create state-level SEO landing pages with dynamic routing, city listings, and aggregated deal statistics.

Purpose: Establish state landing pages (e.g., /california, /texas) that serve as entry points for location-based SEO, showing all cities within a state with their deal counts.
Output: Dynamic [state] route with generateStaticParams, state metadata, breadcrumb schema, and glassmorphic city listings UI.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/24-seo-foundation/24-RESEARCH.md

**Current state:**
- Phase 24 SEO foundation complete (metadata, robots.ts, sitemap.ts, JSON-LD schemas)
- `generateStateMetadata()` exists in `src/lib/seo/metadata.ts`
- `BreadcrumbSchema` component ready in `src/components/seo/`
- Mock data has 4 states: Texas (3 cities), California (1 city), New York (1 city), Florida (1 city)
- sitemap.ts already references `/california` route

**Mock data structure (src/lib/mock-data/locations.ts):**
- Cities have: id, name, state, stateCode, coordinates, isActive
- `getCities()` returns all cities
- `getDealCountForCity(cityId)` returns mock deal counts
- `getBusinessCountForCity(cityId)` returns mock business counts

**SEO patterns from Phase 24:**
- generateStaticParams() for SSG pre-rendering
- generateMetadata() async function for dynamic metadata
- BreadcrumbSchema with items prop for page-specific trails
- Server Components for schema generation

@src/lib/seo/metadata.ts
@src/lib/seo/schemas.ts
@src/components/seo/breadcrumbSchema.tsx
@src/lib/mock-data/locations.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create state data helpers</name>
  <files>src/lib/mock-data/states.ts</files>
  <action>
    Create new file with state-level data aggregation functions:

    1. Define SUPPORTED_STATES array with state info:
       - California: slug 'california', code 'CA'
       - Texas: slug 'texas', code 'TX'
       - New York: slug 'new-york', code 'NY'
       - Florida: slug 'florida', code 'FL'

    2. Export `getStates()` - returns all supported states

    3. Export `getStateBySlug(slug: string)` - finds state by URL slug

    4. Export `getCitiesForState(stateCode: string)` - filters cities by state code

    5. Export `getStateStats(stateCode: string)` - returns aggregated stats:
       - cityCount: number of cities in state
       - dealCount: sum of deals across all cities
       - businessCount: sum of businesses across all cities

    6. Export `slugifyCity(cityName: string)` - converts city name to URL slug
       - Example: "Los Angeles" â†’ "los-angeles"

    Import from './locations' for city data access.
    All functions should filter by isActive === true.
  </action>
  <verify>TypeScript compiles without errors</verify>
  <done>states.ts exports all helper functions with proper types</done>
</task>

<task type="auto">
  <name>Task 2: Create state landing page route</name>
  <files>src/app/[state]/page.tsx</files>
  <action>
    Create dynamic state route with SSG support:

    1. Import dependencies:
       - `generateStateMetadata` from '@/lib/seo/metadata'
       - `BreadcrumbSchema` from '@/components/seo'
       - `buildCanonicalUrl` from '@/lib/seo/metadata'
       - State helpers from '@/lib/mock-data/states'
       - `Link` from 'next/link'
       - Phosphor icons: `MapPin`, `Storefront`, `Tag`, `ArrowRight`

    2. Export `generateStaticParams()`:
       ```typescript
       export async function generateStaticParams() {
         const states = getStates()
         return states.map((state) => ({ state: state.slug }))
       }
       ```

    3. Export `generateMetadata({ params })`:
       - Get state from slug using `getStateBySlug(params.state)`
       - Return notFound metadata if state not found
       - Use `generateStateMetadata(state.name, cityCount, dealCount)`

    4. Define `StatePageProps` interface:
       ```typescript
       interface StatePageProps {
         params: Promise<{ state: string }>
       }
       ```

    5. Export default async Server Component:
       - Await params (Next.js 15 pattern)
       - Get state by slug, return notFound() if missing
       - Get cities and stats for the state
       - Build breadcrumb items: [{ name: 'Home', url: '/' }, { name: state.name, url: `/${state.slug}` }]

    6. Page layout structure:
       - BreadcrumbSchema component at top
       - Hero section with state name, deal count, city count
       - City grid with cards linking to future city pages
       - Each city card shows: name, deal count, business count, arrow link

    Use glassmorphic styling consistent with existing pages.
    Mark as Server Component (no 'use client').
  </action>
  <verify>Run `npm run build` - static params should generate 4 state pages</verify>
  <done>State page renders with city listings and proper SEO metadata</done>
</task>

<task type="auto">
  <name>Task 3: Create city listing card component</name>
  <files>src/components/features/cityCard.tsx</files>
  <action>
    Create reusable city card for state landing pages:

    1. Define props interface:
       ```typescript
       interface CityCardProps {
         name: string
         slug: string
         stateSlug: string
         dealCount: number
         businessCount: number
       }
       ```

    2. Component structure:
       - Link wrapper to `/${stateSlug}/${slug}` (future city page)
       - Glassmorphic card styling matching existing patterns:
         - `bg-glass-light/60 backdrop-blur-md rounded-xl border border-white/10`
         - Hover state with scale and shadow transitions
       - City name as heading (font-semibold text-lg)
       - Stats row: deal count icon + business count icon
       - Arrow indicator for navigation affordance

    3. Icons from Phosphor:
       - MapPin for location identity
       - Tag for deals
       - Storefront for businesses
       - ArrowRight for navigation cue

    4. Mark as Server Component (no 'use client').

    5. Export from component and add to features index if one exists.
  </action>
  <verify>Component renders properly in state page</verify>
  <done>CityCard component displays city info with proper styling and links</done>
</task>

<task type="auto">
  <name>Task 4: Update sitemap with all states</name>
  <files>src/app/sitemap.ts</files>
  <action>
    Update sitemap to dynamically include all supported states:

    1. Import `getStates` from '@/lib/mock-data/states'

    2. Replace hardcoded California state page with dynamic generation:
       ```typescript
       const states = getStates()
       const statePages: MetadataRoute.Sitemap = states.map((state) => ({
         url: `${baseUrl}/${state.slug}`,
         lastModified: new Date(),
         changeFrequency: 'weekly',
         priority: 0.8,
       }))
       ```

    3. Keep existing static pages (home, /deals)

    4. Remove or comment out Orange County city pages for now (Phase 26 will handle city pages properly)

    Result: sitemap.xml should list /, /deals, /california, /texas, /new-york, /florida
  </action>
  <verify>Run dev server, visit /sitemap.xml and verify all state URLs present</verify>
  <done>Sitemap dynamically lists all supported state pages</done>
</task>

<task type="auto">
  <name>Task 5: Visual verification</name>
  <files>N/A</files>
  <action>
    Use Chrome browser automation to verify the state pages:

    1. Navigate to http://localhost:3000/california
    2. Take screenshot and verify:
       - Page title shows "Medspa Deals in California"
       - City listings display (Los Angeles)
       - Glassmorphic styling is correct
       - Breadcrumb shows Home > California

    3. Navigate to http://localhost:3000/texas
    4. Take screenshot and verify:
       - Shows 3 cities (Austin, Dallas, Houston)
       - Deal counts and business counts display
       - Links point to correct city URLs

    5. Check page source for JSON-LD structured data

    6. Test 404 behavior by visiting /invalid-state
  </action>
  <verify>Screenshots confirm proper rendering and styling</verify>
  <done>All state pages render correctly with SEO elements</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds with static generation of 4 state pages
- [ ] /california, /texas, /new-york, /florida routes all render
- [ ] Each state page shows correct city listings
- [ ] BreadcrumbSchema JSON-LD appears in page source
- [ ] State metadata (title, description, OG tags) is correct
- [ ] sitemap.xml includes all state URLs
- [ ] Visual design matches glassmorphic system
- [ ] No TypeScript errors
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- State pages are SEO-ready with proper metadata and structured data
- City cards link to future city pages (Phase 26)
</success_criteria>

<output>
After completion, create `.planning/phases/25-state-pages/25-01-SUMMARY.md`
</output>
