# Phase 27 Plan 01: Neighborhood Landing Pages

**Dynamic [state]/[city]/[neighborhood] routes with SSG, provider listings, and aggregated deal statistics**

## Prerequisites

- [x] Phase 24: SEO Foundation complete
- [x] Phase 25: State Pages complete
- [x] Phase 26: City Pages complete
- [x] NeighborhoodCard component exists (links to neighborhood routes)

## Context

**Phase Goal**: Build neighborhood-level pages showing all providers and deals within a specific neighborhood. This is the FINAL level in the location hierarchy - no further drill-down.

**URL Pattern**: `/{state}/{city}/{neighborhood}` (e.g., `/texas/austin/downtown-austin`)

**Key Difference from City Pages**: Neighborhood pages display actual deal cards and provider info, not another level of location navigation.

**Data Flow**:
- locations.ts has `LocationArea` data (neighborhoods)
- cities.ts has `slugifyNeighborhood()` function
- deals.ts has deals with `businessId` linking to businesses
- businesses.ts has `locationAreaId` linking to neighborhoods

## Scope

- **Estimate**: ~15 min execution time
- **Context budget**: ~40% (focused data helpers + single route + sitemap update)
- **Files**: 3 created, 2 modified

## Tasks

### Task 1: Create neighborhood data helpers

**Goal**: Add helper functions to retrieve neighborhood data and stats

**File**: `src/lib/mock-data/neighborhoods.ts` (create)

**Implementation**:
```typescript
// Functions to create:
// - getNeighborhoodBySlug(stateSlug, citySlug, neighborhoodSlug) -> LocationArea | undefined
// - getNeighborhoodStats(neighborhoodId) -> { dealCount, businessCount }
// - getDealsForNeighborhood(neighborhoodId) -> AnonymousDeal[]
// - getAllNeighborhoodsWithCityAndState() -> Array<{ neighborhood, city, state, slugs }>
```

**Dependencies**:
- Import from `./locations` (getAreaById, getAreasForCity, getCityById)
- Import from `./states` (getStateBySlug, SUPPORTED_STATES)
- Import from `./cities` (getCityBySlug, slugifyNeighborhood, getAllCitiesWithState)
- Import from `./deals` (deals array, transformToAnonymousDeal)
- Import from `./businesses` (businesses array)

**Pattern**: Follow `cities.ts` structure exactly

**Acceptance**:
- [ ] `getNeighborhoodBySlug` validates state → city → neighborhood chain
- [ ] `getNeighborhoodStats` returns accurate counts for the neighborhood
- [ ] `getDealsForNeighborhood` returns AnonymousDeal[] filtered by neighborhood
- [ ] `getAllNeighborhoodsWithCityAndState` returns all 16 neighborhoods with full slugs

---

### Task 2: Create neighborhood landing page route

**Goal**: Build dynamic [state]/[city]/[neighborhood]/page.tsx with SSG support

**File**: `src/app/[state]/[city]/[neighborhood]/page.tsx` (create)

**Implementation**:
- `generateStaticParams` - Generate params for all 16 neighborhoods
- `generateMetadata` - SEO metadata using `generateLocationMetadata`
- Page component with:
  - BreadcrumbSchema (Home > State > City > Neighborhood)
  - Visual breadcrumb navigation
  - Hero section with neighborhood stats
  - Deal grid using existing DealCard component (client boundary)
  - Empty state if no deals

**Pattern**: Follow `[state]/[city]/page.tsx` structure, but show deals instead of neighborhood cards

**Server Component Strategy**:
- Main page is Server Component
- Wrap DealCard grid in client boundary since DealCard uses 'use client'

**Acceptance**:
- [ ] Route generates 16 static pages (one per neighborhood)
- [ ] Metadata includes neighborhood + city + state in title
- [ ] Breadcrumbs show full hierarchy: Home > State > City > Neighborhood
- [ ] Deal grid displays all deals for that neighborhood
- [ ] Empty state shows when no deals available

---

### Task 3: Update sitemap with neighborhood URLs

**Goal**: Add neighborhood pages to dynamic sitemap generation

**File**: `src/app/sitemap.ts` (modify)

**Implementation**:
- Import `getAllNeighborhoodsWithCityAndState` from neighborhoods.ts
- Add neighborhood pages with priority 0.6 and weekly changeFrequency
- URL format: `${baseUrl}/${stateSlug}/${citySlug}/${neighborhoodSlug}`

**Pattern**: Follow existing state/city sitemap pattern

**Acceptance**:
- [ ] Sitemap includes all 16 neighborhood URLs
- [ ] Priority is 0.6 (lower than cities at 0.7)
- [ ] URLs follow correct pattern

---

### Task 4: Visual verification checkpoint

**Goal**: Verify neighborhood pages render correctly

**Actions**:
1. Run dev server: `npm run dev`
2. Navigate to `/texas/austin/downtown-austin`
3. Verify:
   - Breadcrumbs display: Home > Texas > Austin > Downtown Austin
   - Hero section shows neighborhood name and stats
   - Deal cards render with proper glassmorphic styling
   - Navigation back to city page works
4. Check sitemap at `/sitemap.xml` includes neighborhoods

**Acceptance**:
- [ ] Page renders without errors
- [ ] Visual styling matches city pages (glassmorphic theme)
- [ ] Deal cards display with proper spacing
- [ ] Sitemap includes neighborhood URLs

---

## Files Summary

| File | Action | Purpose |
|------|--------|---------|
| `src/lib/mock-data/neighborhoods.ts` | Create | Neighborhood data helpers |
| `src/app/[state]/[city]/[neighborhood]/page.tsx` | Create | Neighborhood landing page route |
| `src/app/sitemap.ts` | Modify | Add neighborhood URLs |

## Success Criteria

1. 16 neighborhood pages generated via SSG
2. Each page shows deals filtered to that neighborhood
3. Full breadcrumb navigation hierarchy works
4. Sitemap includes all neighborhood URLs
5. Visual design consistent with city pages
