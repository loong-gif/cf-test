# Phase 28 Plan 01: Provider Landing Pages

**Dynamic provider routes with SSG, business profiles, and deal listings**

## Prerequisites

- [x] Phase 24: SEO Foundation complete
- [x] Phase 25: State Pages complete
- [x] Phase 26: City Pages complete
- [x] Phase 27: Neighborhood Pages complete
- [x] Business data with slug field exists (`businesses.ts`)

## Context

**Phase Goal**: Build individual provider/business pages showing the medspa profile, location info, and all their deals. This completes the location SEO hierarchy.

**URL Pattern**: `/{state}/{city}/provider/{slug}` (e.g., `/texas/austin/provider/glow-aesthetics-austin`)

**Key Design Decision**: Provider pages are nested under city, not neighborhood, because:
1. A provider can serve multiple neighborhoods
2. Cleaner URL structure for SEO
3. Easier for users to share/bookmark

**Data Flow**:
- businesses.ts has Business objects with `slug`, `city`, `state` fields
- deals.ts has deals linked to businesses via `businessId`
- Need to create provider helpers for SSG

## Scope

- **Estimate**: ~15 min execution time
- **Context budget**: ~40% (data helpers + single route + sitemap update)
- **Files**: 2 created, 1 modified

## Tasks

### Task 1: Create provider data helpers

**Goal**: Add helper functions to retrieve provider data and deals

**File**: `src/lib/mock-data/providers.ts` (create)

**Implementation**:
```typescript
// Functions to create:
// - getProviderBySlug(stateSlug, citySlug, providerSlug) -> Business | undefined
// - getDealsForProvider(businessId) -> AnonymousDeal[]
// - getAllProvidersWithCityAndState() -> Array<{ business, stateSlug, citySlug }>
```

**Dependencies**:
- Import from `./businesses` (businesses array, getBusinessById)
- Import from `./states` (getStateBySlug, SUPPORTED_STATES)
- Import from `./cities` (getCityBySlug, slugifyCity)
- Import from `./deals` (deals array, toAnonymousDeal)

**Pattern**: Follow `neighborhoods.ts` structure

**Acceptance**:
- [ ] `getProviderBySlug` validates state → city → provider chain
- [ ] `getDealsForProvider` returns all active deals for the business
- [ ] `getAllProvidersWithCityAndState` returns all 6 businesses with full slugs

---

### Task 2: Create provider landing page route

**Goal**: Build dynamic [state]/[city]/provider/[slug]/page.tsx with SSG support

**File**: `src/app/[state]/[city]/provider/[slug]/page.tsx` (create)

**Implementation**:
- `generateStaticParams` - Generate params for all 6 providers
- `generateMetadata` - SEO metadata with provider name + city + state
- Page component with:
  - BreadcrumbSchema (Home > State > City > Provider Name)
  - Visual breadcrumb navigation
  - Provider profile section (name, description, rating, contact info)
  - Deals grid using existing DealCard component
  - Map placeholder or address display
  - Empty state if no deals

**Pattern**: Follow `[state]/[city]/[neighborhood]/page.tsx` structure, but display provider info instead of neighborhood stats

**Server Component Strategy**:
- Main page is Server Component
- Wrap DealCard grid with client boundary since DealCard uses 'use client'

**Acceptance**:
- [ ] Route generates 6 static pages (one per provider)
- [ ] Metadata includes provider name + city + state in title
- [ ] Breadcrumbs show: Home > State > City > Provider Name
- [ ] Provider profile section displays business details
- [ ] Deals grid shows all deals from this provider
- [ ] Contact info displayed (phone, email, website)

---

### Task 3: Update sitemap with provider URLs

**Goal**: Add provider pages to dynamic sitemap generation

**File**: `src/app/sitemap.ts` (modify)

**Implementation**:
- Import `getAllProvidersWithCityAndState` from providers.ts
- Add provider pages with priority 0.5 and weekly changeFrequency
- URL format: `${baseUrl}/${stateSlug}/${citySlug}/provider/${slug}`

**Pattern**: Follow existing neighborhood sitemap pattern

**Acceptance**:
- [ ] Sitemap includes all 6 provider URLs
- [ ] Priority is 0.5 (lower than neighborhoods at 0.6)
- [ ] URLs follow correct pattern with `/provider/` segment

---

### Task 4: Visual verification checkpoint

**Goal**: Verify provider pages render correctly

**Actions**:
1. Run dev server: `npm run dev`
2. Navigate to `/texas/austin/provider/glow-aesthetics-austin`
3. Verify:
   - Breadcrumbs display: Home > Texas > Austin > Glow Aesthetics
   - Provider profile section shows name, rating, description
   - Contact info displays (phone, email, website)
   - Deals grid renders with proper glassmorphic styling
   - Navigation back to city page works
4. Check sitemap at `/sitemap.xml` includes providers

**Acceptance**:
- [ ] Page renders without errors
- [ ] Visual styling matches neighborhood pages (glassmorphic theme)
- [ ] Provider profile displays all relevant info
- [ ] Deal cards display with proper spacing
- [ ] Sitemap includes provider URLs

---

## Files Summary

| File | Action | Purpose |
|------|--------|---------|
| `src/lib/mock-data/providers.ts` | Create | Provider data helpers |
| `src/app/[state]/[city]/provider/[slug]/page.tsx` | Create | Provider landing page route |
| `src/app/sitemap.ts` | Modify | Add provider URLs |

## Success Criteria

1. 6 provider pages generated via SSG
2. Each page shows provider profile and all their deals
3. Full breadcrumb navigation hierarchy works
4. Sitemap includes all provider URLs
5. Visual design consistent with neighborhood pages
